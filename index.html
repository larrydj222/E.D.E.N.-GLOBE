<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <!-- âœ… Allow pinch zoom -->
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,maximum-scale=8,user-scalable=yes" />
  <title>MAP E.D.E.N.</title>

  <!--
    ðŸ” LOCKED INDEX.HTML (WELCOME ROUTE)
    WELCOME MUST ONLY OPEN: assets/welcome3.html
    NEVER: welcome.html, welcome1.html, or any other welcome file path.
  -->

  <style>
    :root{
      --bg0:#06070b;
      --bg1:#0b0f18;
      --glass: rgba(10,12,18,0.62);
      --stroke: rgba(255,255,255,0.12);
      --text: rgba(255,255,255,0.92);
      --muted: rgba(255,255,255,0.72);
      --green:#39ff88;
    }

    html,body{
      height:100%;
      margin:0;
      background: radial-gradient(1200px 900px at 70% 10%, rgba(91,188,255,0.10), transparent 55%),
                  radial-gradient(900px 700px at 20% 20%, rgba(246,194,74,0.08), transparent 55%),
                  radial-gradient(900px 700px at 80% 80%, rgba(160,120,255,0.08), transparent 55%),
                  linear-gradient(180deg, var(--bg0), var(--bg1));
      color:var(--text);
      font-family: -apple-system, system-ui, Segoe UI, Roboto, Arial;
      -webkit-font-smoothing: antialiased;
      overflow-x:hidden;
    }

    .wrap{
      max-width: 980px;
      margin: 0 auto;
      padding: 22px 18px 44px;
    }

    .card{
      background: var(--glass);
      border: 1px solid var(--stroke);
      border-radius: 22px;
      padding: 18px;
      box-shadow: 0 18px 60px rgba(0,0,0,0.45);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .topRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
    }

    .brand{
      display:flex;
      align-items:center;
      gap: 12px;
      min-width:0;
    }

    .logo{
      width: 44px;
      height: 44px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.16);
      background: rgba(255,255,255,0.06);
      overflow:hidden;
      flex: 0 0 auto;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .logo img{
      width:100%;
      height:100%;
      object-fit: cover;
      opacity:0.95;
    }

    h1{
      margin:0;
      font-size: 18px;
      font-weight: 900;
      letter-spacing: 0.2px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .sub{
      margin: 4px 0 0;
      font-size: 12px;
      font-weight: 750;
      color: var(--muted);
      letter-spacing: 0.2px;
    }

    .nav{
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content:flex-end;
    }

    .btn{
      appearance:none;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(0,0,0,0.22);
      color: var(--text);
      padding: 10px 14px;
      border-radius: 999px;
      font-size: 13px;
      font-weight: 900;
      letter-spacing: 0.2px;
      cursor:pointer;
      transition: transform .06s ease, background .2s ease, border-color .2s ease;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .btn:active{ transform: scale(0.98); }
    .btn.active{
      border-color: rgba(57,255,136,0.65);
      background: rgba(57,255,136,0.14);
      box-shadow: 0 0 24px rgba(57,255,136,0.14);
    }

    .hint{
      margin: 14px 0 0;
      font-size: 12px;
      font-weight: 750;
      color: rgba(255,255,255,0.62);
      line-height: 1.45;
    }

    /* FULLSCREEN PANEL */
    .panel{
      position:fixed;
      inset:0;
      background: rgba(0,0,0,0.60);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      display:none;
      z-index: 9999;
    }
    .panel.open{ display:block; }

    .panelInner{
      position:absolute;
      inset: 14px;
      border-radius: 18px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(10,12,18,0.78);
      box-shadow: 0 30px 90px rgba(0,0,0,0.55);
    }

    .panelTop{
      height: 52px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding: 0 10px 0 14px;
      border-bottom: 1px solid rgba(255,255,255,0.10);
      background: rgba(0,0,0,0.20);
    }
    .panelTitle{
      font-size: 13px;
      font-weight: 900;
      letter-spacing: 0.2px;
      color: rgba(255,255,255,0.86);
      display:flex;
      align-items:center;
      gap: 10px;
    }
    .liveDot{
      width:10px;height:10px;border-radius:999px;
      background: rgba(57,255,136,0.90);
      box-shadow: 0 0 18px rgba(57,255,136,0.18);
    }

    .close{
      appearance:none;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(0,0,0,0.25);
      color: rgba(255,255,255,0.9);
      width: 40px;
      height: 36px;
      border-radius: 12px;
      font-size: 18px;
      font-weight: 900;
      cursor:pointer;
    }

    iframe{
      width:100%;
      height: calc(100% - 52px);
      border:0;
      background: transparent;

      /* âœ… Helps iOS gestures inside iframe */
      touch-action: pan-x pan-y pinch-zoom;
    }

    @media (max-width: 560px){
      .panelInner{ inset: 10px; }
      .btn{ width: 100%; text-align:center; }
      .nav{ width: 100%; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <div class="topRow">
        <div class="brand">
          <div class="logo">
            <img src="assets/asset_1.png" alt="MAP E.D.E.N. Logo" />
          </div>
          <div style="min-width:0;">
            <h1>MAP E.D.E.N.</h1>
            <div class="sub">Tap Welcome to read â€¢ scroll â€¢ pinch to zoom</div>
          </div>
        </div>

        <div class="nav">
          <!-- ðŸ” LOCKED: WELCOME ONLY -->
          <button class="btn" id="btnWelcome" data-page="assets/welcome3.html" data-title="WELCOME">WELCOME</button>

          <button class="btn" id="btnMission"  data-page="mission.html"     data-title="MISSION">MISSION</button>
          <button class="btn" id="btnSwitch"   data-page="switchboard.html" data-title="SWITCHBOARD">SWITCHBOARD</button>
        </div>
      </div>

      <div class="hint">
        Behavior: When a button is pressed, it turns green.
        Welcome opens <b>assets/welcome3.html</b> in an expandable panel (scroll + pinch zoom).
      </div>
    </div>
  </div>

  <!-- Expandable panel -->
  <div class="panel" id="panel" aria-hidden="true">
    <div class="panelInner" role="dialog" aria-modal="true" aria-label="Expanded Page">
      <div class="panelTop">
        <div class="panelTitle" id="panelTitle">
          <span class="liveDot" aria-hidden="true"></span>
          <span>WELCOME</span>
        </div>
        <button class="close" id="closeBtn" aria-label="Close">Ã—</button>
      </div>

      <!-- ðŸ” iframe is how we expand; welcome3.html itself controls its own scroll -->
      <iframe id="panelFrame" title="Expanded Content" src=""></iframe>
    </div>
  </div>

  <script>
    (function(){
      // ðŸ” HARD-LOCKED ROUTE:
      const WELCOME_LOCKED_URL = "assets/welcome3.html";

      const panel = document.getElementById('panel');
      const frame = document.getElementById('panelFrame');
      const title = document.getElementById('panelTitle').querySelector('span:last-child');
      const closeBtn = document.getElementById('closeBtn');
      const buttons = Array.from(document.querySelectorAll('.btn'));

      function setActive(btn){
        buttons.forEach(b => b.classList.toggle('active', b === btn));
      }

      // âœ… Force-rewrite ANY old welcome references to the locked welcome3 page
      function normalizeUrl(url, label){
        const u = String(url || "").trim();

        // If the user clicked WELCOME (or URL contains any "welcome" legacy), force to welcome3:
        const isWelcomeLabel = String(label || "").toUpperCase() === "WELCOME";
        const looksLikeLegacyWelcome =
          /(^|\/)welcome(\d+)?\.html(\?|#|$)/i.test(u) || /welcome\.html/i.test(u);

        if (isWelcomeLabel || looksLikeLegacyWelcome) return WELCOME_LOCKED_URL;

        return u;
      }

      function openPanel(url, label){
        const safeUrl = normalizeUrl(url, label);
        title.textContent = label || 'OPEN';

        frame.src = safeUrl;

        panel.classList.add('open');
        panel.setAttribute('aria-hidden','false');

        // Prevent background scroll, keep panel content in iframe scrollable
        document.documentElement.style.overflow = 'hidden';
        document.body.style.overflow = 'hidden';
      }

      function closePanel(){
        panel.classList.remove('open');
        panel.setAttribute('aria-hidden','true');
        frame.src = '';
        document.documentElement.style.overflow = '';
        document.body.style.overflow = '';
      }

      buttons.forEach(btn => {
        btn.addEventListener('click', () => {
          setActive(btn); // âœ… turns green

          // ðŸ” even if someone edits data-page wrong, WELCOME is still forced
          openPanel(btn.dataset.page, btn.dataset.title);
        });
      });

      closeBtn.addEventListener('click', closePanel);

      // Tap outside panel closes
      panel.addEventListener('click', (e) => {
        if(e.target === panel) closePanel();
      });

      // ESC closes (desktop)
      window.addEventListener('keydown', (e) => {
        if(e.key === 'Escape' && panel.classList.contains('open')) closePanel();
      });
    })();
  </script>
</body>
</html>
